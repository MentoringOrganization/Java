# 💡 (12주차) 자바 예상 질문 정리

## ~ [스프링 핵심 원리 - 기본편] (10주차)
- 출처 : 인프런 김영한님

## 1. AppConfig란?

애플리케이션 전체 동작 방식을 구성(config)하기 위해 **구현 객체를 생성** 및 **연결**하는 책임을 가지는 별도의 설정 클래스이다.

### 구현 객체
- Impl : 인터페이스

```MemberServiceImpl, MemoryMemberRepository, .. ```

AppConfig는 애플리케이션의 실제 동작에 필요한 위와 같은 구현 객체를 생성한다.

### 생성자를 통한 주입(연결)
```MemberServiceImpl → MemoryMemberRepositroy```

또한 생성한 객체 인스턴스의 참조(레퍼런스)를 생성자를 통해서 주입(연결)해준다.

![image](https://github.com/MentoringOrganization/Java/assets/103405457/5f8ce4d7-3d95-425b-8d90-140d4dd2b81d)

AppConfig의 등장으로 애플리케이션이 크게 사용 영역과 객체를 생성하고 구성(Configuration)하는 영역으로 분리되었다.

## 2. BeanFactory와 ApplicationContext의 차이점은?

우선 개발자는 기존에 AppConfig를 사용해서 직접 객체를 생성하고 DI를 했지만, 이제부터는 Spring Container를 통해서 사용한다.

![image](https://github.com/MentoringOrganization/Java/assets/103405457/1ccc8d92-5c39-4704-b79f-633464cb2acc)

### BeanFactory

스프링 컨테이너의 최상위 인터페이스이며 **스프링 빈을 관리하고 조회**하는 역할을 담당한다. 추가로 ```getBean()```을 제공한다.

### ApplicationContext

BeanFactory 기능을 모두 상속받아서 제공하는데, 이때 Application을 개발할 때는 Bean을 관리하고 조회하는 기능은 물론이고 수많은 부가기능이 필요하다. 이때, 이 부가 기능들을 ApplicationContext가 제공한다.

![image](https://github.com/MentoringOrganization/Java/assets/103405457/66a146d5-6cac-40dc-9b50-a9895bd24890)

1) 메세지 소스를 활용한 국제화 기능 : 한국에서 들어오면 한국어를, 영어권에서 들어오면 영어로 출력한다.
2) 환경 변수 : 로컬, 개발, 운영 등을 구분해서 처리한다.
3) 애플리케이션 이벤트 : 이벤트를 발행하고 구독하는 모델을 편리하게 지원한다.
4) 편리한 리소스 조회 : 파일, 클래스패스, 외부 등에서 리소스를 편리하게 조회

따라서, ApllicationContext는 Bean 관리 기능 + 편리한 부가 기능을 제공한다. 또한 BeanFactory를 직접 사용할 일은 거의 없으며, BeanFactory나 ApllicationContext를 Spring Container(스프링 컨테이너)라 한다.

## 3. Spring Container(스프링 컨테이너)에 대해 다시 한 번 정리해보자.

![image](https://github.com/MentoringOrganization/Java/assets/103405457/f135913f-e6dd-492d-bf5f-7ce784165ff0)

### @Configuration

스프링 컨테이너는 @Confinguration이 붙은 AppConfig를 설정 정보로 사용한다.

여기서 ```@Bean```이라 적인 메서드를 모두 호출해서 반환된 객체를 스프링 컨테이너 등록하며, 스프링 컨테이너에 등록된 객체를 ```스프링 빈```이라고 한다.

### Spring Bean

스프링 빈은 @Bean이 붙은 메서드의 명을 스프링 빈의 이름으로 사용한다. (```memberService```)

스프링 컨테이너를 통해서 스프링 빈을 찾을 경우, ```applicationContext.getBean()``` 메서드를 사용해서 찾을 수 있다.

## 4. BeanDefinition(스프링 빈 설정 메타정보)이란?

![image](https://github.com/MentoringOrganization/Java/assets/103405457/0d1846f2-73fc-4740-af76-6f80161a7a3a)

![image](https://github.com/MentoringOrganization/Java/assets/103405457/72539b32-f3e4-4d43-a928-7bf4f06be5fc)

스프링은 역할과 구현을 개념적으로 나눈 ```BeanDefinition```, 즉 빈 설정 메타정보를 사용해서 다양한 설정 형식을 지원한다.

스프링은 자바 코드를 읽어서 BeanDefinition을 만들고, @Bean 및 <bean> 당 각각 하나씩 메타정보가 생성되며 메타정보를 기반으로 스프링 빈을 생성한다.

## 5. 스프링 컨테이너는 기본적으로 싱글톤 방식을 통해 웹 어플리케이션을 지원한다. 왜 싱글톤 방식으로 지원할까? 또 설계 시 'stateless'하게 설계해야 한다는 점은 무슨 뜻일까?

### 왜 싱글톤 방식으로 지원할까?

스프링은 기본적으로 기업용 온라인 서비스 기술을 지원하기 위해 만들어졌다. 이때, 일반적인 웹 어플리케이션은 여러 고객이 동시에 요청을 한다.

![image](https://github.com/MentoringOrganization/Java/assets/103405457/c941ab06-c8e1-4e38-83ee-fe9e43c7803e)

따라서 기존의 AppConfig는 요청할 때마다 객체를 새로 생성하기 때문에 메모리 낭비가 심했다.
> ex. 고객 트래픽이 초당 100 -> 초당 100개 객체가 생성되고 소멸

이를 해결하기 위해 해당 ```객체는 딱 1개만 생성```되며, 이 객체를 ```공유```하도록 설계하기 위해 싱글톤 패턴을 기반으로 설계하게 되었다.

이때, 스프링 컨테이너는 싱글톤 객체를 생성하고 관리하는 기능(```싱글톤 레지스트리```) 덕분에 싱글톤 패턴의 단점을 해결하면서 객체를 싱글톤으로 유지할 수 있다. (?? 아직 제대로 이해못함)

![image](https://github.com/MentoringOrganization/Java/assets/103405457/c59bba09-d9ab-4a95-9182-44e9435b111a)

### 'stateless'한 설계

싱글톤 패턴 및 싱글톤 컨테이너가 사용하는 객체 인스턴스를 하나만 생성해서 공유하는 싱글톤 방식은 여러 클라이언트가 하나의 객체 인스턴스를 공유하기 때문에, 싱글톤 객체를 상태를 유지(stateful)하게 설계하면 안된다.

즉, 다음과 같은 이유로 인해 무상태(stateless)하게 설계해야 한다.
- 특정 클라이언트에 의존적인 필드가 있으면 안된다.
- 특정 클라이언트가 값을 변경할 수 있는 필드가 있으면 안된다.
- 가급적 읽기만 가능해야 한다. 등등

**꼭 스프링 빈의 필드에 공유 값을 설정하지 않도록 주의하자.**

## 6. 스프링 빈의 이벤트 라이프 사이클은?

1) 스프링 컨테이너 생성
2) 스프링 빈 생성
3) 의존관계 주입
4) 초기화 콜백 : 빈이 생성되고, 빈의 의존관계 주입이 완료된 후 호출
5) 사용
6) 소멸 전 콜백 : 빈이 소멸되기 직전에 호출
7) 스프링 종료

## 7. 스프링에서 지원하는 빈 생명주기 콜백 방식은?

### 인터페이스(InitializingBean, DisposableBean)

### 설정 정보에 초기화 메서드, 종료 메서드 지정

### @PostConstruct, @PreDestory

## 8. 빈 스코프란?

스코프는 번역 그대로 빈이 존재할 수 있는 범위를 의미하며, 스프링은 다양한 스코프를 지원한다.

### 싱글톤

![image](https://github.com/MentoringOrganization/Java/assets/103405457/2b922c7f-96ba-46a4-9c28-e0f6f723d612)

기본 스코프이며 스프링 컨테이너의 시작과 종료까지 유지되는 가장 넓은 범위의 스코프이다.

### 프로토타입

![image](https://github.com/MentoringOrganization/Java/assets/103405457/9ed441ef-d6e5-4d5b-97a4-80a8c12601e3)
![image](https://github.com/MentoringOrganization/Java/assets/103405457/539ba07b-6b61-400f-ba04-0fd25e38101b)


스프링 컨테이너는 프로토타입 빈의 생성과 의존관계 주입까지만 관여하고 더는 관리하지 않는 매우 짧은 범위의 스코프이다.

### 웹 관련 스코프(request, session, application)

![image](https://github.com/MentoringOrganization/Java/assets/103405457/4682a6e0-76c9-4774-bc7a-79c428538874)

웹 요청이 들어오고 나갈 때까지 유지되는 스코프, 웹 세션(```HTTP Session```)이 생성되고 종료될 때까지 유지되는 스코프, 웹의 서블릿 컨텍스트(```Servlet Context```)와 같은 범위로 유지되는 스코프, 웹 소켓(```Web Socket```)과 동일한 생명주기를 가지는 스코프가 있다.

## [스프링 MVC 2편 - 백엔드 웹 개발 활용 기술]
- 출처 : 인프런 김영한님



